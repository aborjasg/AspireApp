
using AspireApp.Libraries.Models;
using AspireApp.ServiceDefaults.Shared;
using static alglib;

namespace AspireApp.Libraries
{
    public static class FakeData
    {
        public static double[,] GetNcpData()
        {
            var result = new double[Constants.NUM_COLS, Constants.NUM_ROWS];
            var random = new Random();

            for (int k = 0; k < 200; k++)
                result[random.Next(0, Constants.NUM_COLS), random.Next(0, Constants.NUM_ROWS)] = 1;

            return result;
        }

        public static double[,] GetLineChartData()
        {
            int n = 21; // # points
            double[] arrX = new double[n];
            for (int i = 0; i < n; i++)
                arrX[i] = (-n/2) + i;

            Func<double, double> Func0 = x => Math.Exp(x);
            var arrY0 = CalculateY(Func0, arrX);

            Func<double, double> Func1 = x => Math.Sin(x);
            var arrY1 = CalculateY(Func1, arrX);

            Func<double, double> Func2 = x => Math.Cos(x);
            var arrY2 = CalculateY(Func2, arrX);

            Func<double, double> Func3 = x => Math.Tan(x);
            var arrY3 = CalculateY(Func3, arrX);

            Func<double, double> Func4 = x => Math.Sqrt(x);
            var arrY4 = CalculateY(Func4, arrX);

            Func<double, double> Func5 = x => Math.Pow(x, 2);
            var arrY5 = CalculateY(Func5, arrX);

            var arrData = Array.CreateInstance(typeof(double), new int[] { 7, n });
            arrData.SetValue(arrX, new int?[] { 0, null });
            arrData.SetValue(arrY0, new int?[] { 1, null });
            arrData.SetValue(arrY1, new int?[] { 2, null });
            arrData.SetValue(arrY2, new int?[] { 3, null });
            arrData.SetValue(arrY3, new int?[] { 4, null });
            arrData.SetValue(arrY4, new int?[] { 5, null });
            arrData.SetValue(arrY5, new int?[] { 6, null });

            return (double[,])arrData;
        }

        public static double[,] GetHistogramData()
        {
            int n = 20;
            var arrX = new int[n];
            var arrY = new int[n];
            var random = new Random();

            var list = new List<int>();
            for (int i = 0; i < n; i++)
            {
                arrX[i] = i;
                arrY[i] = random.Next(0, 100);
            }
            
            var arrData = Array.CreateInstance(typeof(double), new int[] { 2, n });
            arrData.SetValue(arrX, new int?[] { 0, null });
            arrData.SetValue(arrY, new int?[] { 1, null });
            return (double[,])arrData;
        }

        public static double[,] GetHeatMapData()
        {
            var result = new double[Constants.NUM_COLS, Constants.NUM_ROWS];
            var random = new Random();

            for (int j = 0; j < result.GetLength(0); j++)
                for (int i = 0; i < result.GetLength(1); i++)                
                    result[j, i] = (double)(random.Next(55, 95))/100d;
        
            return result;
        }


        public static double[,] GetEnergyCal_XrayRaw()
        {
            Array result = new double[,,,] { { { { 19899.984388736004, 20401.072964444065, 20464.62527830333, 21845.96800228376, 24234.25552665023, 14618.899857384475 }, { 21610.114755779876, 21819.716520885893, 21585.48749695419, 22823.867044466424, 25068.88843709389, 15821.267815593585 }, { 23110.450458722724, 23042.944307681657, 22532.637565455036, 23630.93503707526, 25747.146326037728, 16689.19275282603 }, { 24414.556131571782, 24084.95199954373, 23321.214764768, 24283.489326231225, 26285.105713161243, 17270.18138837528 }, { 25535.996408334297, 24959.935271184502, 23966.358375855223, 24797.847258055273, 26698.84311814395, 17611.740441534803 }, { 26488.335923017486, 25682.089797316352, 24483.207679678846, 25190.32617866835, 27004.435060665353, 17761.37663159806 }, { 27285.13930962859, 26265.61125265165, 24886.90195720102, 25477.243434191423, 27217.958060404966, 17766.596677858524 }, { 27939.971202174835, 26724.69531190279, 25192.580489383872, 25674.916370745428, 27355.4886370423, 17674.907299609666 }, { 28466.396234663316, 27073.537649782003, 25415.38255718942, 25799.6623344512, 27433.103310256716, 17533.815216144852 }, { 28874.443751074847, 27274.40141253857, 25562.203739536624, 25897.810113518964, 27503.399137140106, 17265.60799721927 }, { 29129.822572669273, 27471.959401157994, 25702.819784858264, 25973.77433063856, 27558.552043916847, 17845.3301477754 }, { 29372.24173331599, 27608.541684583055, 25805.303695820305, 26012.151652619985, 27587.351364522285, 17830.41606108809 }, { 29554.053556071405, 27705.53859219113, 25879.116360652322, 26021.343359419665, 27595.45446336416, 18057.52536621365 }, { 29688.02219140566, 27766.29361598427, 25930.774391554743, 26012.91516884519, 27568.586776888984, 18168.891873781587 }, { 29785.12765164531, 27794.74045049293, 25965.766114120957, 25970.34955137013, 27565.671350045734, 18643.48476020516 }, { 29879.323128081494, 27749.116862314968, 25943.08432232529, 25931.23277505434, 27561.612092936455, 18789.50843509909 }, { 29902.97637168888, 27734.536338292488, 25964.791720416113, 25879.256374698874, 27543.433124784868, 18864.008442265706 }, { 29863.417956656198, 27762.325450062934, 25999.210218151464, 25818.430068225996, 27520.658962561498, 18895.259420507875 }, { 29843.585182318395, 27759.197275254995, 26017.15084279313, 25752.82489823402, 27493.084293658845, 19061.581831928583 }, { 29818.445290104202, 27734.725758943794, 26024.035983545335, 25691.27817552447, 27462.913595774437, 19298.54646112822 }, { 29777.76922442939, 27692.33425065919, 26021.187571665967, 25619.135176585132, 27422.55575980379, 20022.526487788004 }, { 29736.264885047443, 27638.12371359349, 26006.867328144584, 25868.05220158226, 27743.618166637865, 19311.26076066382 }, { 29695.32771829478, 27563.483660130583, 25979.320942265673, 26027.16006621934, 27631.792960239512, 18877.642504443207 }, { 29824.38482183795, 27558.518783682932, 26318.528854560704, 25357.46567552447, 27196.76752235969, 18577.300417096572 }, { 29812.41059296511, 27705.013455308886, 26113.97856825466, 24833.439356151695, 26830.665785173587, 18099.220211988217 }, { 29886.78918701969, 27276.034521557027, 25768.29549901088, 24416.5391726865, 26522.145335253856, 18112.931870628283 }, { 29391.58138401545, 26954.3151337288, 25464.808131951486, 24091.407109993, 26261.650075965932, 18157.642837690542 }, { 29001.783141984724, 26696.157117159597, 25196.930550180477, 23851.72320046428, 26048.847738217966, 17963.80795278629 }, { 28662.56923661263, 26491.500286664246, 24963.355148492024, 23688.5393267686, 25871.20439886468, 18311.895227754754 }, { 28381.185733430666, 26336.82403107429, 24762.99864013576, 23597.937356667695, 25720.804512813775, 18341.84533023727 }, { 28161.17665333663, 26218.821483344673, 24592.27877751966, 23553.52256406937, 25634.592284428265, 18636.525373380256 }, { 28000.544271729024, 26130.16401860439, 24440.81056322371, 23579.777648778694, 25570.825299564145, 18897.62726106515 }, { 27835.912760864445, 26145.16767357515, 24383.078058708743, 23639.395546668842, 25514.76523979462, 19073.17078746694 }, { 27713.042788240895, 26194.11106094472, 24337.46376024813, 23735.27713994943, 25476.975644278056, 19207.244585626555 }, { 27682.176947167623, 26215.59166809986, 24291.587364550964, 23861.90885147907, 25454.715449776275, 19422.532156575988 }, { 27684.612264935084, 26230.516565617345, 24261.84059848343, 24018.214328201928, 25448.23224472525, 19536.1076460554 }, { 27715.501060658047, 26235.626587403844, 24246.26175323919, 24188.8476020524, 25455.58643289174, 19804.573059998755 }, { 27781.18228270827, 26222.047450120273, 24242.124156131635, 24385.804061317394, 25477.13365368065, 18622.6447260921 }, { 27882.67290878326, 26179.25294189301, 24253.522098239762, 23999.923012699113, 24812.514738131973, 18289.909424807847 }, { 28019.96553219227, 26099.10038986342, 24268.003954176584, 23012.166337002527, 24089.215636108132, 18089.39145453494 }, { 27863.69062822484, 25824.07598039203, 23574.794862974315, 22518.511022245046, 23576.239235752666, 17758.064667899234 }, { 27573.08428649224, 25000.501293572863, 23020.377440230368, 22010.68042655648, 23057.709888487447, 17339.458089668533 }, { 26776.526272789688, 24505.895808250083, 22574.20349945523, 21498.88425209255, 22540.446827341937, 17045.630772703735 }, { 26288.524972050098, 23985.66569200768, 22117.90100762516, 20980.502701811616, 22021.746223196777, 16662.27444888766 }, { 25773.911650040005, 23456.70503310962, 21657.28580079682, 20459.25249756325, 21502.550990425305, 16321.493876132245 }, { 25249.279089267166, 22925.94117647048, 21198.039875014234, 19946.134209092896, 20979.090729274063, 15935.212031303672 }, { 24716.31960210973, 22387.595856983033, 20737.345620484935, 19424.150871459602, 20484.353070175337, 15757.860168701909 }, { 24196.79946752081, 21816.46704434687, 20252.081505847855, 18919.357728471412, 19999.815051312824, 15407.776634703514 }, { 23647.400563295378, 21285.193129371528, 19810.072282421643, 18417.050839926527, 19515.831333849233, 15122.506016368463 }, { 23073.66408310389, 20796.96604102157, 19387.41657350065, 17922.403265107125, 19038.05347365545, 14618.647370570965 }, { 22535.714998279906, 20305.583677330487, 18965.27937234826, 17438.572010090502, 18567.138329893267, 14292.25924492597 }, { 22004.89448242737, 19809.922227955416, 18542.186657923314, 16962.894976923435, 18099.006811862084, 14119.809361025042 }, { 21470.70736942427, 19312.74543486976, 18116.090618191633, 16485.60059052853, 17626.714894364093, 14062.586328975965 }, { 20948.260219584805, 18814.601801685494, 17687.83536148369, 16167.647771901078, 17316.46509144585, 13385.379049134208 }, { 20437.605270324406, 18313.99532378732, 17256.62835038978, 15784.49677144242, 16824.320465686193, 13016.529150183402 }, { 20049.39566850122, 17813.872516769778, 17024.696135764163, 15018.03853127501, 16189.785134302181, 12561.623874842271 }, { 19565.75639978204, 17425.433630030875, 16507.73836859297, 14366.76528637764, 15608.906737329356, 12050.54787295029 }, { 19027.492113146334, 16789.969656576, 15936.622778351028, 13799.13652390774, 15069.835271901085, 11603.758979761438 }, { 18298.249763501804, 16230.25446121423, 15386.317828373967, 13305.429835311254, 14572.770482169404, 11269.878264390498 }, { 17641.197386337488, 15712.381786778964, 14852.959558823457, 12877.513670307242, 14112.911882954868, 10893.869316878745 }, { 17026.05989135412, 15238.125472996142, 14344.259438424422, 12515.045880632893, 13694.971602310448, 10583.04103242169 }, { 16455.130693871037, 14800.098092965183, 13861.495313037429, 12213.341854431774, 13313.735648864744, 10390.03638129223 }, { 15928.069476694109, 14390.861483774726, 13403.464030787689, 11952.648778809711, 12989.623853342444, 10273.503092391878 }, { 15444.942036463633, 14007.080524022407, 12972.097003640572, 11747.556383298876, 12698.669157063347, 9873.85468266249 }, { 14984.709110910371, 13710.893479102102, 12628.183110451722, 11584.848100131809, 12446.562012670503, 9789.164591933217 }, { 14569.06853428499, 13448.245287954298, 12314.521399495412, 11456.963880288902, 12227.905013759831, 9610.467596175851 }, { 14234.112505016557, 13185.379425381198, 12030.752554896168, 11361.844219412855, 12046.509986670048, 9689.581369682328 }, { 13939.400652878043, 12937.539079520635, 11785.978367589669, 11290.802248165292, 11895.889687965771, 9809.91579950689 }, { 13687.156837661898, 12702.293558651469, 11584.344065330755, 11234.327746961302, 11771.518192437736, 9801.801596003852 }, { 13492.699944817043, 12479.147470903505, 11428.318007539217, 11197.617213478903, 11677.202972709494, 9221.287330867975 }, { 13352.462461300245, 12262.103471505501, 11320.207964252897, 10883.303527405062, 11298.37408267395, 9153.380726120813 }, { 13263.359699289009, 12043.564757481881, 11253.744198629689, 10321.38724056869, 10895.893450435678, 8800.949629486255 }, { 13010.898932891807, 11813.49987458428, 10846.731173317226, 10031.100103199124, 10621.270912165985, 8511.099891784157 }, { 12698.850540362282, 11350.508255933897, 10542.948077915322, 9754.043952814998, 10361.029619596326, 8381.241844398537 }, { 12274.651380288897, 11052.070981682093, 10299.228564671432, 9487.002551312877, 10108.355650154748, 8306.305308307494 }, { 11978.772753984576, 10761.016182203824, 10063.955753353925, 9227.293759316546, 9861.591496101317, 8036.687044920268 }, { 11696.152057533482, 10486.798245613985, 9842.216449518355, 8978.463321293386, 9625.018034772342, 7907.447888000192 }, { 11423.618714883558, 10222.098970874851, 9627.923105865106, 8738.202266798491, 9386.975945275726, 7760.582426757214 }, { 11158.742776057738, 9963.035417383278, 9417.627855893774, 8496.968929165192, 9163.018597351176, 7541.0895718667225 }, { 10915.250164831963, 9700.530415089965, 9202.82449690398, 8268.966119854334, 8947.398914975303, 7215.46116772729 }, { 10674.635685414463, 9468.000343997202, 9017.047905200048, 8049.827754127928, 8738.161872204979, 7230.608728213472 }, { 10418.747262355182, 9252.517991772687, 8834.701435471807, 7827.8241349902155, 8523.873985924738, 7028.001902734744 }, { 10182.133904512048, 9035.586350475818, 8651.730908152693, 7610.429885477545, 8311.558078202, 6885.866389318852 }, { 9949.35274767797, 8817.116758399223, 8467.116364235711, 7394.7492546725925, 8097.275677961204, 6779.180161392009 }, { 9715.572999082626, 8595.922769034472, 8279.020184755149, 7176.947243005354, 7878.009162509995, 6762.017379027601 }, { 9481.842266511821, 8371.321461844931, 8084.188424492564, 7017.329689112453, 7709.928099200169, 6350.32669705306 }, { 9257.811822755373, 8145.45201955047, 7889.56762054233, 6819.973956541648, 7484.8125680827525, 6052.8056379715335 }, { 9081.751583820618, 7920.994883040897, 7769.106814728778, 6481.079033367701, 7204.851832143641, 5790.280791336974 }, { 8869.386774739092, 7717.129995126667, 7551.784299392235, 6197.119574876704, 6946.725887942863, 5599.363669590616 }, { 8635.175254056257, 7453.693745699998, 7310.385785747011, 5947.909783138373, 6698.589218911216, 5512.638616557707 }, { 8328.495875616289, 7212.387466316901, 7060.914627766277, 5728.476052774884, 6459.099769951808, 5184.568523535119 }, { 8051.424490812367, 6989.453309540156, 6813.079087117269, 5543.830162108677, 6239.885798288584, 5085.936292426303 }, { 7776.537316534763, 6775.385337833931, 6561.9169031647425, 5383.506363949063, 6030.380091875902, 5223.515225461504 }, { 7487.884341824575, 6553.889892214198, 6286.444559707415, 5222.774571615929, 5817.6841927590995, 5182.561476966519 }, { 7208.915653785884, 6345.142224945537, 6020.426898494537, 5086.864119295382, 5623.002439036047, 5078.747137835399 }, { 6946.4430048518, 6152.993786549711, 5772.02563287133, 4978.5815813959625, 5450.520188935713, 4882.671446496485 }, { 6707.27814745538, 5981.296027548449, 5549.402476182972, 4900.73353232619, 5304.422800687043, 4564.933641378093 }, { 6498.232834029693, 5833.900398463483, 5360.719141774647, 4856.126546494575, 5188.895632518971, 4096.132960908535 }, { 6326.118817007802, 5714.658349816538, 5214.137342991538, 4847.567198309639, 5108.12404266044, 3446.8686435161294 }, { 6197.74784882277, 5627.421332129346, 5117.818793178825, 4877.862062179893, 5066.293389340389, 2587.7399276291876 }, { 6119.93168190766, 5576.040795923635, 5079.925205681693, 4949.817712513857, 5067.589030787756, 1489.3460516760256 } } } };
            return (double[,])(result.Squeeze().MoveAxis(0, 1));
        }

        public static double[,] GetEnergyCal_XrayPB()
        {
            Array result = new double[,,,]{{{{358.4691107193365, 352.8270434392081, 339.85365067079465, 321.89764051332025, 368.3604720884455, 313.44920068417224}, {362.5608600408975, 362.1902940818141, 356.70358097551895, 343.54236630690286, 393.45380373762566, 333.54864306224437}, {368.27091455490586, 371.1802871063143, 371.8992894306846, 359.79579761973014, 413.7668068933227, 349.4107924358828}, {375.36288066639923, 379.94391321952764, 385.65982792971, 371.6424271036388, 430.06759456341024, 361.75702954793036}, {383.60036478041513, 388.6280631282728, 398.2042483660132, 380.06674741046527, 443.1242797557621, 371.30873514123004}, {392.74697330199155, 397.3796275393687, 409.75160263301245, 386.05325119204616, 453.7049754782518, 378.78728995862485}, {402.5663126361657, 406.34549715963396, 420.5209426241258, 390.5864311002181, 462.57779473875337, 384.9140747429577}, {412.82198918797553, 415.6725626958874, 430.7313202327716, 394.6507797868174, 470.51085054514033, 390.41047023707154}, {423.2776093624564, 425.5077148549458, 440.60178735236576, 399.2307899036788, 478.2722559052838, 395.99785718380724}, {429.54254099300334, 435.5674485437429, 450.7481438481804, 411.1606252149963, 491.81970960898735, 407.54862544432774}, {437.64749957000134, 447.70878482971915, 461.75988992087844, 425.45920407636527, 506.67418802316, 419.4983946795072}, {447.72146972824, 461.72850375530106, 473.7799886767549, 441.8786979704141, 522.3814212819606, 433.65774782134866}, {459.89507725604636, 477.25142973855975, 486.6754063467469, 459.87197210755426, 538.9268002522621, 448.87383900928575}, {474.109624039672, 494.26039875014095, 500.32323916408427, 479.28606237816535, 555.3915942839097, 461.83007252608417}, {489.275609878452, 512.9605334823963, 514.6747326854694, 499.12081470014664, 570.465847523217, 474.8034091560578}, {505.7017723024858, 532.4064936647147, 528.6529676929225, 518.2615633241576, 583.2812858330439, 486.973791709664}, {523.6376239823389, 551.439202069714, 541.8062363834396, 536.4514533883703, 593.2453202041021, 495.24408754729717}, {542.175241514732, 569.4702084049967, 553.1417555326198, 552.2629787295008, 599.0662947196392, 498.46376203990127}, {560.5036263043202, 585.2279411764678, 561.8704133700237, 564.2540957172315, 600.019987673429, 499.06348182547623}, {578.3145138172199, 598.2918744983343, 567.1493127221621, 571.9449819401417, 595.0906432748509, 465.5276631120261}, {594.4491636566878, 607.3797156289387, 568.7872233688769, 562.1037725031506, 565.5581176183897, 441.9936288843001}, {608.0099687535803, 611.0779655429394, 565.4921812292141, 532.6567301628228, 528.0335755647262, 407.48906017085}, {609.5093631750917, 605.0891848698515, 537.4847243722024, 507.24881750945747, 488.9016920364613, 371.512168902647}, {601.7344197913053, 578.6992890723512, 506.3833276000434, 474.83068168787753, 443.93428935901625, 330.2346670393287}, {577.1178405572728, 553.0979926327229, 471.0018203187685, 436.6181021385141, 394.98883442265605, 287.9420149638789}, {552.0497291021644, 519.7539488017404, 429.89364393417975, 393.5392371861006, 343.6274115640392, 244.81601163857235}, {519.2617138229535, 479.8972451553697, 384.2314599816516, 347.1108566964781, 291.92667483659994, 203.69695275771028}, {479.80259216259367, 434.3853163341339, 336.11012211902147, 299.4026559454177, 242.00201740052628, 165.51239465084197}, {434.7610222451533, 385.00394163513164, 287.17711558307394, 251.97822067423337, 195.70249971333467, 131.34980220158175}, {385.7011989737396, 333.624294088979, 239.4031361082433, 206.83081785345618, 154.05115167411915, 102.12159944387061}, {334.4378619137697, 282.4443297786937, 194.56722996215936, 165.34779555096813, 117.88085153652045, 78.14766440201772}, {283.1321271929811, 233.36956412681917, 154.06200908725987, 128.58390307877474, 87.93252637312192, 59.10993220387541}, {233.85826955050914, 187.842406260749, 118.92845573902017, 97.4925682261204, 64.08856495814669, 45.34452399380783}, {188.2433708863653, 147.110211701639, 89.31072984749413, 71.96281246416659, 45.84352425180576, 35.66238103428488}, {147.5324396571487, 112.08749355005104, 65.52453847035858, 51.887358817795864, 32.59206943011106, 29.668427860910295}, {112.66553434239137, 83.22904125100293, 47.1124082674003, 36.8631607613804, 23.370244954706916, 25.262817480793363}, {83.78688295493595, 60.224730535488746, 33.50088507625256, 25.999140006879813, 17.213532708404916, 23.688910030386303}, {60.96897574819372, 42.57215342277241, 23.949511237243314, 18.206007768604426, 13.44388903222101, 23.199192323127964}, {43.304760061919296, 29.903329606696328, 17.45061847838542, 13.470821150097398, 11.359989536750318, 22.871920149638694}, {30.573045665634524, 21.102815760807143, 13.700962475633458, 10.77878826969379, 10.337722881550231, 22.930759803921454}, {21.763698973741434, 15.827091216603522, 11.617690058479475, 9.398316563467446, 9.913764189886432, 23.18763795722956}, {16.278544604976414, 12.718857499139942, 10.500429996559976, 8.749964166953289, 9.775857126476273, 23.18213579291355}, {13.059859104460433, 11.035453216374215, 9.943659700722344, 8.518798016282496, 9.749960583648615, 24.36585003153297}, {11.376184580801123, 10.306681310438394, 9.652551730975036, 8.45927902715667, 9.70797321121431, 24.795336567863018}, {10.998500984214333, 10.501757909547816, 9.837474140484645, 8.791398814642811, 9.877349154817871, 24.903925928314795}, {11.411914906069615, 11.204320330715106, 10.265791922275717, 9.324927199193509, 10.15285213134961, 24.495982518250965}, {12.101532937736456, 11.998005890952832, 10.704870069372756, 9.869634001261309, 10.429245857699799, 23.37587074303405}, {12.552461670584348, 12.466451907273571, 10.922073574800256, 10.23528904129876, 10.60129405075869, 21.34795500802659}, {12.249807695982785, 12.1932956966899, 10.684767431582724, 10.231662139758406, 10.563760427416563, 18.216599718591123}, {10.678677605301248, 10.76217457621439, 9.760316632744654, 9.668523117092796, 10.211408704563675, 13.786169280090174}, {7.324177989909239, 7.756725862859618, 7.916086171310549, 8.35564179375448, 9.439002599090285, 7.861028097886282}}}};
            return (double[,])(result.Squeeze().MoveAxis(0, 1));
        }

        public static double[,] GetEnergyCal_XrayCEO2()
        {
            Array result = new double[,,,] {{{{6133.013288088139, 6411.718970970454, 6748.965702996597, 7259.201001891984, 8214.457101870961, 6005.365352549402}, {6890.351050983259, 7125.640507945382, 7315.231495516091, 7753.950822129533, 8622.068571013931, 6274.487912617532}, {7546.818625957938, 7718.50529791595, 7758.789063694435, 8125.467885826358, 8896.309643508963, 6441.8275839209955}, {8105.755442741181, 8197.519016299259, 8089.49826836802, 8384.727936995949, 9051.538912598422, 6519.943909337614}, {8570.500931061997, 8569.887338512404, 8317.218970373238, 8542.706719651798, 9102.114971524674, 6521.396431745213}, {8944.394520649394, 8842.815939972481, 8451.81103054648, 8610.3799778074, 9062.396413530083, 6458.744694021617}, {9230.775641232372, 9023.51049609659, 8503.134309724135, 8598.723455476247, 8946.741831857014, 6344.548239044645}, {9432.983722539944, 9119.176682301822, 8481.048668742596, 8518.71289667183, 8769.509819747835, 6191.366609692124}, {9554.358194301067, 9137.020174005229, 8395.413968438212, 8381.324045407597, 8545.058970444861, 6011.759348841846}, {9599.181422715237, 9056.42260778576, 8250.103571838052, 8205.665896256121, 8301.881346032525, 5833.388397976121}, {9517.36363375755, 8939.799223856166, 8068.843807332835, 7989.476317939418, 8037.827105549783, 5658.230177158554}, {9400.605119825663, 8764.737562349459, 7851.381131034247, 7745.016630116921, 7767.858251633949, 5480.128121058339}, {9223.250784743677, 8545.535933379158, 7611.715962188933, 7486.686697339718, 7505.556705796317, 5327.746423861916}, {8997.244227296138, 8293.064395568128, 7362.719240912703, 7229.264003554603, 7258.819265279175, 5223.642228528813}, {8737.961862888387, 8021.652853027137, 7118.487780931051, 6979.793300653561, 7053.085805813519, 5120.234452041025}, {8468.02301198253, 7735.685199518367, 6882.4859856954145, 6757.821748509312, 6887.690079979327, 5069.354026917759}, {8184.653702270342, 7472.158883728894, 6687.3257725604535, 6567.169927473882, 6763.516433035169, 5059.733914545326}, {7903.242353227803, 7246.803634904219, 6532.044282479042, 6415.425678677872, 6685.602668845283, 5050.675069516086}, {7656.154042684288, 7049.503203474339, 6414.941054638198, 6307.540724257508, 6654.429480564123, 5071.008209350967}, {7444.541096921189, 6886.653394106147, 6337.572468753551, 6243.034686389145, 6664.4661664373025, 5179.196114264394}, {7274.357094226544, 6767.468115755042, 6303.075260147888, 6218.8115862572795, 6714.379450464364, 5515.8507499856405}, {7153.673833275966, 6692.644650842761, 6309.241514734518, 6334.574206656315, 6927.148230564122, 5478.677452413687}, {7080.354675495894, 6656.306222050191, 6349.290190345114, 6474.298224114174, 7031.108201467688, 5922.345235279756}, {7047.275955368749, 6658.128788448862, 6419.877000678442, 6612.481099859537, 7196.8993273539945, 6158.968383905707}, {7054.585881660173, 6693.9758332975025, 6518.166270412895, 6721.849980769602, 7344.356196608763, 6281.015477935205}, {7102.825285529664, 6762.912882099724, 6641.871915670511, 6778.432859321849, 7455.531071431986, 6241.191124512672}, {7192.534998136684, 6864.005460359098, 6788.707852573293, 6758.257727993733, 7512.4762140236235, 5992.199930782499}, {7324.255850640698, 6996.319093579199, 6956.387997243247, 6637.352579262701, 7497.243886583631, 5486.746503889079}, {7498.528674201165, 7158.919307263599, 7142.626265802375, 6391.7454056062, 7391.886351311968, 4677.535450976807}, {7715.894299977547, 7350.871626915875, 7345.136574372684, 5997.464199501679, 7178.45587040859, 3517.2713791900724}, {7976.893559129305, 7571.241578039599, 7561.6328390761755, 5430.536953426591, 6839.00470607346, 1958.6588956732708}}}};
            return (double[,])(result.Squeeze().MoveAxis(0, 1));
        }

        public static double[,] GetEnergyCal_Am241()
        {
            Array result = new double[,,,] { { { { 8.567242180533675, 10.851195900664983, 11.558397147643781, 8.615060524303068, 11.791551817982523, 10.01297288359789, 9.64123934126416, 9.374419966598019, 10.338913043478279, 9.13274047564073, 8.812293724380233, 9.688296167629886, 9.56852917457303, 11.06107045454548, 6.364746195142459, 8.643328425229697, 9.39313797177519, 5.466892001244908, 9.449645178874313, 10.190576617444599, 10.181730744161456, 9.86970705434129, 9.340334914610985, 9.07939915973489, 6.787710560812435, 8.744689268000883, 9.802546618852446, 8.710636517806655, 10.698828739124252, 11.480258682529474, -2.1943831678595913, 10.305432229258109, 9.004165427140414, 11.13276252122241, 11.08697394232567, 9.762372163489125 }, { 7.986731160922702, 9.979884358942996, 8.60564916567565, 11.14799419398907, 9.86597640369483, 11.084650123921307, 10.282010563812065, 8.963423243656727, 9.393247742887482, 10.627901564818764, 8.01169112039463, 8.174520284979188, 7.107686450871981, 9.3045055875576, 10.114977460209843, 9.491726505639512, 10.052713613671266, 8.514385777147176, 8.5479876980964, 6.8337654810456385, 8.272790161678707, 8.027683543212042, 9.346259174340311, 6.667730626044914, 8.785497899417727, 9.167622853436995, 8.21295872283951, 10.343814971070373, 8.938001168148425, 8.368517938726129, 9.201615614062568, 8.693679905079172, 10.084136772847003, 8.560925747348143, 9.37030692167577, 9.388160149572641 }, { 8.970444633550613, 9.281258590871516, 9.436916782229268, 8.438816215772718, 9.104828798770257, 8.573686062664038, 9.3779788448862, 7.852383125505355, 9.92565714622991, 9.736262447229763, 8.588068644797545, 8.508796646395211, 8.302566747748855, 9.300516035252969, 8.24013332562415, 8.974018730489092, 9.520988786231598, 9.638967434740394, 7.964470879393396, 9.29328866709389, 9.685758398753194, 9.367880492267545, 8.899215839699842, 8.437887096774197, 9.693249234063678, 9.489426814516115, 9.155574103130597, 8.47958911307272, 7.53781743546147, 8.869431299572469, 8.977240675403166, 8.604626456767214, 8.893717872312372, 5.36464733250623, 9.742321588247826, 8.870275525837755 }, { 9.000378988889693, 9.72149172291865, 8.560008098589634, 8.569747550511977, 9.04108026673395, 8.810470986179816, 8.995803960964409, 8.966085714285768, 8.838798872357202, 8.749895467300263, 9.667014316936886, 7.753141743658375, 8.107625714486623, 9.337170129648129, 9.202962477091063, 9.785742265328494, 8.468945054662711, 8.756012896074104, 9.109589989759343, 8.622248932871074, 9.031815622213543, 9.12767072594854, 8.884198567071323, 9.131641859227514, 9.275423604374794, 8.123089781746017, 9.226508842270107, 8.598173115136255, 8.778018536977918, 8.81538741427483, 9.618030940314739, 8.84733544114507, 8.608682396673373, 9.458408142134274, 8.432209470960984, 9.917356172360272 }, { 10.315751096077534, 10.11698129129951, 10.08354754098361, 9.350189969031192, 8.584560621961984, 8.426985663068358, 8.999784001107507, 9.921186744731834, 9.561521846633227, 9.94725980264407, 8.446469123782343, 8.878188587532392, 9.369109801714352, 9.819125836647622, 7.910355303122131, 9.219029237009899, 8.614154782654929, 9.42401140636521, 8.56737116957165, 8.557983209213226, 9.421410087719288, 9.088325706523086, 8.368648098132546, 8.463471957589135, 8.523317808144633, 9.116062801260654, 9.234497463012346, 10.480372320302635, 10.064797851170859, 8.235440461468642, 10.626615232672187, 9.09348470996217, 8.892988457209974, 5.6692053931451625, 10.263872545582018, 9.1352331378299 }, { 9.901624799704202, 9.611714402295277, 8.225734531993652, 8.729804992943677, 8.698472348791277, 8.70505407361457, 9.251413257251933, 9.587918243224763, 8.537069944653638, 8.563473953242095, 9.427894610886831, 8.86039722736016, 9.112104608803293, 8.271172140630426, 7.923705534990312, 9.083968227108137, 8.137687959682246, 10.211102414978136, 8.882702727795362, 8.759556815629956, 10.125109591596846, 7.90012082114184, 8.173588477047147, 9.93248484070618, 8.81430003642214, 9.620946798266743, 9.265600916764846, 9.033197360921434, 9.723978728913934, 9.28300408462507, 7.453787922485802, 10.308584538003004, 8.788557766500602, 8.8729964196961, 10.939022961613304, 9.13061241319442 }, { 9.278311963353445, 9.644319740681993, 8.063504722024248, 9.232741402040574, 8.575328650129755, 9.894973514779814, 9.731246205483338, 9.637854705761775, 9.085597255701302, 9.010482687756841, 9.41560873695331, 8.709182285401866, 9.55585085369934, 9.339291391511438, 8.531213234921722, 9.88581275842332, 7.580807090758704, 8.347829110779927, 7.648690964436057, 9.321192082111438, 7.714415670789478, 8.591235582010576, 7.484944396052825, 9.049991127774291, 8.552611768044613, 9.664255073429281, 9.008424098591114, 9.358287193065614, 9.207011648082194, 10.161575224983139, 9.441410383601195, 9.684790851401388, 9.109240295493144, 9.641870017679189, 10.229729834791073, -4259523.380602249 }, { 8.738306261782576, 9.053889517432488, 8.314032792193437, 8.826396136779863, 8.935628934447088, 8.7687407154948, 9.0807364570192, 8.774253548837478, 9.144940471747333, 10.097764381720445, 9.063146374458881, 9.760984088717464, 8.734259164222912, 9.444680443548386, 8.758663191422599, 8.291921910314322, 8.482598536929338, 10.095329205069149, 8.060224496842963, 9.605254298853659, 9.524290573959028, 8.992327429017102, 8.10773333924137, 9.119174595297196, 8.876089158867977, 8.972421540917914, 9.021234191450674, 8.864961450222438, 9.34636256051639, 9.083999330486762, 9.050572079378753, 9.515574523809562, 9.791915275666788, 14.246640333521775, 8.623064113485093, 8.366508681250274 }, { 8.940481604152922, 9.877468234099751, 9.349035590378001, 8.483635165541656, 8.824389120687535, 9.815198972528243, 9.53806041848297, 8.55272063686504, 9.531054655870427, 8.640632220578667, 9.826994953352838, 9.236087400797217, 4.4624293156199215, 9.022340907086395, 8.625634107827636, 9.28850786097449, 9.209050564189859, 9.81831171648988, 8.929659908203917, 9.269601388888887, 9.231126696502791, 9.177566213283214, 7.96343119326292, 8.179785326086929, 8.764822198965085, 7.847294583364246, 9.055393313999652, 9.082173279480493, 8.547599131720709, 8.187939892820573, 9.27415190467844, 8.063478686635953, 8.525806119523573, 8.545030099989681, 9.304864209220334, 7.035031365959817 }, { 8.98202367649995, 9.017407425756701, 9.66346858319794, 8.018086139407643, 8.589773078018482, 8.56465952832744, 8.815236455975061, 8.782957582646603, 8.89338571846735, 9.266622298954978, 9.520746263087936, 8.45212337506019, 8.45474761543052, 8.077692706872362, 9.185891984109993, 8.475489089184023, 9.173695249326151, 8.64987792132979, 8.762565838928644, 9.287075430731782, 9.209079550039391, 8.129335433467702, 7.733434129256295, 8.61115524747548, 8.20045737327191, 8.425330717165892, 8.704696713861814, 9.300874961828079, 8.08389355187682, 8.985096287169, 8.887934229011549, 8.394913391162916, 8.122971125471295, 6.851520119225029, 8.809573043530968, 9.904490559930927 }, { 9.253233012592105, 9.44019515733438, 10.167772572331224, 8.718956887782646, 9.262908151914814, 9.626364682832431, 8.799171740360606, 8.31749583139154, 9.428579093696115, 8.123459593870514, 9.275989199215772, 8.23247890428857, 8.506763642897745, 9.837986264055694, 8.38699968296742, 10.121547720900487, 7.988893507143544, 8.942986647276605, 9.608110414657666, 9.183382139252203, 8.680427041876143, 8.602578666247915, 8.296493466161976, 7.47514672224591, 10.02048013701448, 8.562372108550079, 8.651138287874772, 8.320983772644972, 10.576227497398534, 9.830032324699609, 8.452102290526874, 8.48188631126935, 9.393221321195597, 9.410026653007655, 9.075023869223948, 9.435687891589986 }, { 7.986448205463795, 8.615515933221182, 8.910768497207123, 8.900383149730231, 9.557799324029155, 9.104821102150538, 8.861386198509472, 9.705866300693806, 9.270999212001925, 8.440023573615626, 9.149134108375243, 9.448877755613495, 7.6473452084763025, 8.976720720155, 9.030513620118185, 8.866525717845285, 9.629712129470434, 7.789674606858313, 9.685944259475662, 8.607988739839946, 12.17041958733747, 9.258603608881067, 8.52525592313291, 9.05865570361209, 9.045965031173772, 8.434118276047883, 8.566611687515262, 8.700080364352118, 8.121446245309414, 9.31662510529025, 8.899285325285206, 8.22252616167431, 9.715566877081372, 9.27730407774537, 8.588322463129444, 11.073048460745312 }, { 9.483825452788302, 9.300720079044922, 9.501254402643077, 8.78510655737707, 9.147803262733355, 9.246661754447139, 8.978791486291449, 9.296175501573536, 8.795074225942848, 8.781263638253307, 8.883031006113441, 9.036934353549825, 9.525143500159729, 9.70843790888076, 9.049077577050035, -7.760145161290353, 8.162922261855115, 8.883539212485303, 9.049933382590275, 8.741485627677065, 8.72820581317206, 8.775634051375157, 8.577216624189617, 8.45051653732017, 9.404442361333565, 8.946127070270592, 0.0000003100494154750777, 9.111373636381863, 7.944763824884774, 9.014030498237815, 9.033616664585423, 8.835537598446429, 10.24624996252654, 7.944772973569826, 9.562101210755536, 11.991094582727648 }, { 9.031659925365652, 9.330957977025555, 10.121337107452213, 9.459931871297968, 8.567344343898505, 8.786504024473778, 9.132265240114194, 9.105373275552616, 10.082161576482846, 8.845147521083597, 9.242735173658303, 8.700115780263516, 9.882624928987958, 9.205355842438962, 9.946878848567415, 9.067114471795556, 8.839524170251764, 9.626723831902694, 8.57065105459057, 9.085986723942284, 7.416966015770399, 8.947770113851966, 9.963487219182042, 8.647835495553998, 8.814708199688404, 9.033767444025521, 9.034981467293534, 9.129891175547122, 8.729404009864965, 8.511048828859323, 8.545195781629197, 9.74455687374175, 9.639228581527767, 9.037546660511438, 9.554057142498259, 8.18612581976138 }, { 7.963046362704908, 9.820297375981575, 9.655162534618114, 9.200438059924977, 9.46294152498978, 8.537612084479555, 9.515344135385313, 9.123042483042191, 9.11940791739385, 8.151994397209776, 9.275204615314792, 9.56160291023842, 8.630781541266543, 9.750376204109287, 8.584606764990127, 9.273412452439189, 7.674005200604036, 8.94976374914436, 9.374900852790212, 8.554672681248782, 9.68889145758665, 8.637784704880595, 7.940436717001418, 9.07534531810034, 8.443506735200287, 9.10328843614414, 8.733649803871572, 8.785261314011436, 9.482253055937107, 8.251188528123244, 8.634277585960483, 8.731289845048309, 10.002098969072158, 8.206476133745248, 9.769392140790757, 7.263866453986594 }, { 8.657671954993425, 8.028656601024238, 8.756925951113871, 9.122812605515712, 9.62866720632293, 9.474375989788456, 8.813681600765293, 8.898767243609804, 8.6717891920568, 9.52372951505017, 9.174114898601673, 10.217915980870572, 9.598341132122926, 8.486598657913014, 8.908256184192581, 8.536977008479745, 9.361403691410672, 10.206676273826979, 7.648633981623497, 9.169050922429605, 7.71823945769048, 8.082240615835765, 9.115829454573642, 8.571119058679116, 8.154463716702239, 8.5754224742236, 9.567541741994809, 9.902686225057451, 8.961514842141398, 8.457814551693339, 9.166031391637482, 10.077065380184315, 9.466280928748702, 9.967011272166097, 8.857486765922246, 9.118217809704532 }, { 8.240854345385145, 8.490558052434437, 9.799486955731751, 8.454496565814111, 8.488934944586582, 9.576478362108126, 8.803752888306398, 10.121284496081934, 9.506922211826307, 9.06909892594689, 9.215713240528139, 8.507499148171306, 10.010145152881947, 8.870289615623307, 9.508598743633598, 9.049478421970313, 9.15169825268817, 7.361708554512056, 9.51256205799023, 8.030590012042659, 8.49325445779877, 8.586035719230239, 9.042673812526289, 7.820651152540108, 9.274864461270809, 9.499069097155918, 9.090448697978232, 9.223209212077471, 8.88756574550871, 8.89678425780226, 9.403187423246997, 9.93453223134113, 8.812701828808436, 8.981333629278886, 9.081082407614346, 8.333106174563142 }, { 9.24562893993295, 9.126575335725384, 9.15504843517138, 9.48980283444024, 9.787478387539878, 8.34891034945003, 10.529733119819838, 10.174916816114866, 9.334698703331156, 8.521696424781723, 9.06127837005139, 6.46239331471957, 7.91878495818878, 7.524018698010174, 9.145413454433672, 8.805736189226394, 10.144087754647124, 8.747999426916543, 6.659539997009588, 7.535587124254867, 8.369789248967535, 8.423264187092705, 8.232975550010899, 9.596440836940843, 8.469472770398504, 8.648738068427015, 8.820232307856799, 9.448050371304468, 9.289560706207858, 9.529400034610582, 8.093389008548712, 9.75359585511805, 9.159511111111115, 9.985835784313714, 7.839909138200106, 9.403969055612336 }, { 9.161318902971061, 10.129683163338193, 9.974128341940535, 8.755356114491498, 8.744378808492336, 9.085707691381813, 8.966969904064626, 8.092239883668462, 9.352120507566198, 8.150309905372438, 8.471128261571373, 8.436015124763252, 9.357578625924056, 8.101827116493702, 8.989860471070124, 8.365377356962377, 9.662304212408095, 9.708053100125696, 7.816383800329639, 8.887941085484172, 9.82026699606022, 9.901148111142781, 8.75750403225809, 9.640341550272076, -0.9258411885246289, 7.712305456920269, 8.643146109074955, 10.092489403029113, 9.686687689431665, 6.961223744958517, 8.508269259616405, 7.661616960907914, 8.43315723443228, 8.86092098940486, 8.918590967741935, 9.60045164473685 }, { 8.379226924614755, 8.99881169118111, 9.581384087711974, 8.1604557335002, 9.113316212205184, 9.111845408789748, 9.427017402376883, 9.527975571377716, 10.006925358991722, 8.77065751471612, 9.087311494806016, 9.108376451382966, 10.096343862007153, 9.306277223410149, 10.717244534722084, 8.71682266943968, 8.625914078112828, 8.560212249490895, 9.354121886287274, 8.933344504372783, 9.396089188134262, 8.363442158385084, 8.80477417377616, 8.866334171580512, 9.855753240841594, 8.901372524956649, 8.049017330210766, 9.091689972789844, 9.141524981809418, 9.101965533738017, 4.069788978494614, 12.786960397465442, 8.168495679723506, 9.449749417205602, 9.313874253285562, 9.728769329815975 }, { 7.704275725173126, 10.26307492802681, 9.386925550233215, 9.451414898746378, 8.769984312595987, 8.366457714283264, 8.596692185370301, 9.21013606276729, 8.259005936820458, 9.155195848482947, 8.79014625266295, 9.511189590998534, 8.320616479424224, 9.499292202651873, 9.151195278969915, 9.183021946642675, 9.255024670326463, 9.58913630419277, 7.8828993766842075, 8.508590495807255, 9.387557416781014, 8.972222246137314, 9.377052110038335, 8.825993375576061, 8.856237530644293, 9.640331979764845, 7.830954547472189, 10.126956944694676, 10.736405763809152, 7.775827004622656, 8.245524690987978, 10.443762907625867, 7.437609261953369, 9.39673790322577, 8.78735790738974, 8.212494506959132 }, { 9.31913341027225, 9.497378398702509, 9.380946227566298, 9.108721483470482, 8.770095758522018, 8.908887520670177, 9.869329637539316, 9.712774123384527, 51.036200984304244, 9.111613579534762, 9.467015160922159, 8.066448029579746, 8.032917631959172, 10.248167472991057, 9.405703315160842, 8.9890298246629, 9.136905645154783, 9.024755854619727, 9.345706627812419, 8.656219236009441, 9.733593809099268, 9.116361371472472, 9.178590854343618, 8.751746650507187, 8.42786297244242, 9.279118870967736, 8.142090333345323, 10.252526314422632, 8.921481416549796, 8.73870303605311, 9.894602745037204, 9.174437283629864, 9.96310994737565, 8.989952712609991, 9.072499999999998, 9.18608462643676 }, { 7.5234495987620775, 8.32590572464131, 11.742792280361755, -2.2489871031745494, 8.453889279792357, 9.536986638083853, 9.297356236342303, 9.550258113756705, 9.8773775881618, 9.2880825207356, 8.725714461386183, 10.080885738909508, 8.927703310763611, 8.961656833507668, 8.321730378550164, 8.787396761864642, 9.389892025089623, 9.07297009844995, 9.218640840493002, 10.302319220430114, 8.148709869431649, 9.852585007932312, 9.366571176883461, 8.046285454551537, 9.159670050379738, 9.636111548683687, 7.53687635223973, 9.720071903808496, 8.628219584905636, 8.0074284672463, 9.071347909274635, 9.776016666666656, 8.747330312417077, 8.184028669547786, 8.998969808686681, 8.596658632351264 }, { 9.176998201319194, 10.037835830235679, 10.419904746572115, 9.349153591187921, 9.378689904245348, 9.761558370905071, 9.426323567088033, 10.351422105766261, 7.316431616832723, 7.830430519676227, 8.424569724462316, 9.769624327956976, 8.862282512539373, 10.4291095864467, 9.122079871710227, 7.882250547180519, 9.007324450108861, 9.212797020532165, 9.0374354470123, 9.825515732416733, 9.100231078594945, 8.186918185523012, 10.022287152805973, 9.84032939757823, 9.103212146148792, 10.629267291313546, 10.62954980158726, 9.444627300100372, 9.392173428976804, 8.44381953749523, 8.99434960299692, 9.990164468995026, 8.68242143042702, 8.909690865384626, 12.64134190443604, 9.73043326360537 } } } };
            return (double[,])(result.Squeeze().MoveAxis(0, 1));
        }

        /// <summary>
        /// 
        /// </summary>
        public static void Spline1dBuildLinear()
        {
            double[] x = new double[] { 0, 1, 2, 3 };
            double[] y = new double[] { 1, 5, 3, 9 };
            double[] y2 = new double[] { 1, 5, 3, 9, 0 };
            alglib.spline1dinterpolant s;

            alglib.spline1dbuildlinear(x, y, 4, out s);  // 'expert' interface is used
        }

        /// <summary>
        /// 
        /// </summary>
        /// <param name="a"></param>
        /// <param name="b"></param>
        /// <returns></returns>
        public static double[] LeastSquares(double[,] a, double[] b)
        {
            var result = new double[0];
            alglib.lsfitreport rep;

            alglib.lsfitlinear(b, a, 11, 1, out result, out rep);
            return result;
        }
               
        /// <summary>
        /// 
        /// </summary>
        /// <param name="function"></param>
        /// <param name="x"></param>
        /// <returns></returns>
        public static double[] CalculateY (Func<double, double> function, double[] x )
        {
            double[] y = new double[x.Length];
            for (int i = 0; i < y.Length; i++)
                y[i] = function(x[i]);
            return y;
        }
    }
}
